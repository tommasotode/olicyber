#!/usr/bin/env python3

from pwn import *

HOST = "snecc.challs.olicyber.it"
PORT = 12310


certmio = "6a724c4f0c202718261c7f2c36210b260116222375274f72427f72653e3a1628040b2221604d25382e25162d3214163a1e392e30490b2e26221b1a0d1c32705d060e0d5512161b6c5f191218372206250c303b2b491401112e031a2179310e2e30383b2f5921181e2510382125311e36131e0a0e742f301a1816283637250e3e0e1b200a700335091b306d5a43290b2a0a12200d6623530a2a10281837790c3a3f0f2c30641526283616093e22381b2e2f0f03254d080708253e3c05362b122d1218205374272128181d3c02250406370d6f0352450a3b32033b0602180b55292d1e3420462c341d2e1f122b273625223d3c1400131a12065c3e36352b3a27273d1e052046091337043b185604431d2c161a362766060a06023e36361e4a1e65256d191278510e36350a16183b1b3c210a3534156c08276b220638173d191a5a1037022c6c083728222816183e273817093524577608211d04281a233e3234284d1e503764200a122c01093e0b360b2e171d062c772023382211192d0329085e313d0f304d2f33281811383637250e3e0f1b202c6b36276717170b2e23313821115523234e2f211a56213e383d46060211262c304215240e3616093e223f1b2e72263b3a630a01313d240d5d351a3e380d36003664352f1d3e151e5e26361e1830116b2f752f18111667290d341f350a10150d014b2704122d62182c2002183c0e3d52267027281e3d0b0e354135360e101508001120143d283e350a2439330c2d1c2268600b2b282b030625381c05262f29022c6033271d2d031e2b1414163f061b222160050d1c0835162d323f3e0e0c1c3b075549126b350417261711665c0e29545a2b515a2e3d7d2c1a243732392815342a62062c662a1d15573b2a171c2c162830142455300701342d01182e252a0c000a79515739281c37231c0438197015302f0a685a1927032b0a1a07743720050f074b2a2035050234373e2a6c032a142f21683b23695c11371f2a300e4025132f01434d28345a3d705d294436273031160b6729680d59676d5c0327050b02740c36400b2e702d340d210b1f2b030b1c143a5220073c213d340427461d1915121511460b5a2c01130e2504216c57313a39240a2a07550119133931122e00152e002d481a52133a6b2b2b26023605681554514f2552355c28112d1246183a353c1b305b5b4d121a0105253f3f6c06060a09294b26271d650a2d1a34232b0436285451770d14085a2306151101271b1d3b0a201531320727130d25031105053d35570b660a12172d17381738142a183718032772262f320c582a08351e6a1b140c4e121255260f5f1e161f36383e092b702c34520a573b3c65365f3d35112334063835680c110b241132091d0718170f38253754510f6f051e553b05171c280f6614084905370626600b5616321e442b265205422c1b131c260e0727416b38352e3723793b52385736372530220d373f152701520a5a285b6508651e00110806165149780714392c00693a1623170b323915005037122a1a166c1e3c172729303b51326a230c11187d2c5f26370d0613112d11605106681a2a2f39793b092633324a334f331131406b0b1f4b362b563d682a516b4d30342c2b3a3f23392e25233b2f0077240f15076a302137183256752c0e240e342e1b1d102d36307933210930032764040b6839060e19191a2e29090c0d166e23320544220a563c3e69210e3c190e111820085c066a1f14041226020b232663280b063f301923194a55032f3d195b463216345c63135a36393c59732d4e23462f201e2e15353a09310d22056f26231037061b0803082d3127190e6c6e0004482035320611282a143d12652a3d0b0875352b660c061e09311411390f0c2c276626230808100b2912586e0e213623354c0b21282a3511221e1135051308285b4236230f2d3511393b21122d4d1e075a6420361e2b130e275c3e1e5f001c321366312b3d5c160e2a31370e3a061e552b6223331c2739380511423302201c26134950373040391c24303c6e040a554a237552521618250a59364b18271f252e3b195b5a3a0d28693e1658061536182e0a630f200900280b2340363c5a2b0725381233151d1807160923276c2d08096b01530e091506333059003e2c2136252b006f20361328143b401c0b2f243f0924297015316622371c3c4a220d0b100f135a130f086d2603283d4b412b1c1e091168485b062d5a08690e1543290a3d0a0f564633141e2936072212056a5e346927320e5a2c1e051f6b362b141c16347004084a20126e3f1c1901103a700a350827082b032c0e1b21170143421008703d27564f31300f2030272724180f07316619104f26052a0c672e06414033400a1d185419294d7021263917441d092d0d0953184368230944633824221f69093f6c365a6e28323b291f1d0c243e380c321b3817700b0a70063e6a3d380570170f393730781349395a3b662844223c29011737115b2168141d6b05022030111b7f6d35275734253304392d16371c1438093530154a341b2f23306f3a5c1a282b0e37102e6a3a301604221e0c371f3828300f152e51573255290670083012063a26743823695a04393b3a1a2b1e326b3b233e0804190c362e446633031d4a2e2b741229064d242d671a193c211b056725771708551028171965161929270a36581f392c147317506e0e01691b14020e272c10052f78132c33561a13390a27133a11393017450a4911160411563d031d25231c2409133a010b4458395b0a20193711311b0c6f062d300967661d3d273e381608200a4a1a343c0136385f32166806753d58290a33261521011e3c0521173a06104e1465372f1a17225525405c290c26662752653b31192c24275931473915341d0b54591614382d03665d18161016311c1824505b216d0e33695e374b1c27241b2437722f161d2d360c65103f1756212d15104a070c6b0a373e44010462524d724c4f0c4f27112b721c2a212716290e1c2036644f4f72427f"

r = remote(HOST, PORT)
n = int(r.recvline().decode().strip())
while n != 88:
    r.close()
    r = remote(HOST, PORT)
    n = int(r.recvline().decode().strip())
    print(n)


r.sendline(b"276")
r.recvuntil(b"> ")
r.sendline(b"2")
r.recvuntil(b"> ")
r.sendline(certmio.encode())
print(r.recvline().decode())

r.interactive()

r.close()