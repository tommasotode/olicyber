from Crypto.Util.number import getPrime,bytes_to_long
from Crypto.Util.number import long_to_bytes

with open("output.txt", "r") as f:
    content = f.read().split("\n")[8:]

e = 65537
alice_n = 17076498954505451321861119187729608757416905748867673888110876027453110303809918524948169536577185009725422636230582777751694760854745372838514526794977168980920985183480524141333711115233599125338182976448921374937390114899156362042708864365541798300522589522145664475311378703829810669442629548206236717298608728361314202046190112352158981081513551383513539439992638105251243490030080400407761002218040842348387684329337920895373544435826296548819466755568180630427687532756967027894903752312575345105900871880133312939399972998499864894933353341278217027846929478575996736832500945330491531018098316270751574762249
bob_n = 24013931831232453281518966703896935736579923596763663442887932342463401388694231179675633142563508390638324096418142016403796592874546102637282709981349828515627864402237928489533475173833847031793167583797656645048519100930036698097419117422705349421063067725601837677342686605785991794918193759898208415092096382520677696121700320901801150549995678591709374648264923032295635998712646210679016968529991268307423471583495735852776032376049015007865071024655011075722012619811633975077171223538628559915256165007964674072134567522119172998111045971050032009368095770051750902712736998687296409687016286673471252330313

def sendToAlice(msg):
    pt = bytes_to_long(msg.encode())
    assert pt < alice_n
    ct = pow(pt, e, alice_n)
    return f"bob: {ct}"

def sendToBob(msg):
    pt = bytes_to_long(msg.encode())
    assert pt < bob_n
    ct = pow(pt, e, bob_n)
    return f"alice: {ct}"

upperbound = 2**501
lowerbound = 0
i = 0
while upperbound - lowerbound > 1 and i < len(content):
    mid = (upperbound + lowerbound) // 2

    if sendToBob(f"Yes!, my number is greater than {mid}") == content[i].strip():
        lowerbound = mid
    elif sendToBob(f"No!, my number is lower or equal to {mid}") == content[i].strip():
        upperbound = mid

    i += 2

print(upperbound)
print(long_to_bytes(upperbound))